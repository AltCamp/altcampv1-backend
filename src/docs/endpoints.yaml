openapi: 3.0.0
info:
  title: CoStudy API Docs
  description: CoStudy is an e-learning platform that allows students to post messages to the discussion threads, interact and receive feedback from other students and instructors, and hence create a deeper understanding of the subject matter being discussed. This documentation covers the Mentors' routes
  version: 1.0.0
servers:
  - url: '{scheme}://{host}'
    variables:
      scheme:
        default: https
        enum:
          - http
          - https
      host:
        default: fundaorcostudy.onrender.com # Production server
        enum:
          - localhost:8000 # Development server
          - fundaorcostudy.onrender.com # Production server

paths:
  /auth/mentor:
    post:
      tags:
        - Auth
      summary: This route creates a mentor details in the database
      requestBody:
        description: Mentors' details passed in the body as a request
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/signUpMentorRequest'
      responses:
        '201':
          description: 'Mentor is Created'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MentorCreated'
        '422':
          description: One or more user input not validated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '409':
          description: There is a conflict error as User already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictError'

      deprecated: false
      security: []

  /auth/login:
    post:
      tags:
        - Auth
      summary: logs in user and return a message
      requestBody:
        description: Accepts Mentors' email and password into the body as a request
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/loginMentorRequest'
        required: true
      responses:
        '200':
          description: 'Returns a bearer token'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserToken'
          headers: {}
        '401':
          description: 'Token is  invalid. User not authorized'
          content:
            application/json::
              schema:
                $ref: '#/components/schemas/UnauthorizedError'

      deprecated: false
      security: []

  /mentors/{mentorID}:
    get:
      tags:
        - Mentor
      summary: This returns a single mentor
      description: Accepts the ID of a user and search the database if the user exists
      operationId: getMentorById
      parameters:
        - name: mentorID
          in: path
          description: Mentor ID
          required: true
          schema:
            type: string

      responses:
        '200':
          description: Returns a single mentor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getUser'

        '404':
          description: Mentor Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'

  /mentors:
    get:
      tags:
        - Mentor
      summary: Returns an array of Mentor.
      description: This simply returns all registed mentors found in the database
      responses:
        '200':
          description: A JSON array of user names
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getAllUsers'

  /mentors/update-profile:
    put:
      tags:
        - Mentor
      security:
        - bearer: []
      summary: update mentor details
      description: The accepts the mentor firstname, lastname or both and updates the profile in the database
      requestBody:
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/updateMentorRequest'
      responses:
        '200':
          description: Returns mentor updated profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getUser'

        '404':
          description: Mentor Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'

  /mentors/change-password:
    put:
      tags:
        - Mentor
      security:
        - bearer: []
      summary: update mentor password
      description: This updates the mentors' password who must be logged in
      requestBody:
        description: Accepts Mentors' password in the body as a request
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/updateMentorPasswordRequest'
      responses:
        '200':
          description: Returns the updated Mentor profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/updateUserPassword'

        '404':
          description: Mentor Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'

  /auth/student:
    post:
      tags:
        - Auth
      summary: This route creates a student details in the database
      requestBody:
        description: Students' details passed in the body as a request
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/signUpStudentRequest'
      responses:
        '201':
          description: 'Student is Created'
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/StudentCreated'
        '422':
          description: One or more user input not validated.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ValidationError'
        '409':
          description: There is a conflict error as User already exists
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ConflictError'

      deprecated: false
      security: []

  /students/{studentID}:
    get:
      tags:
        - Student
      summary: This returns a single student
      description: Accepts the ID of a user and search the database if the user exists
      operationId: getSingleStudentById
      parameters:
        - name: studentID
          in: path
          description: Student ID
          required: true
          schema:
            type: string

      responses:
        '200':
          description: Returns a single student
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getStudent'

        '404':
          description: Student Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'

  /students:
    get:
      tags:
        - Student
      summary: Returns an array of Students
      description: This simply returns all registed students found in the database
      responses:
        '200':
          description: A JSON array of user names
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getAllStudents'

  /students/update-profile:
    put:
      tags:
        - Student
      security:
        - bearer: []
      summary: update student details
      description: The accepts the student firstname, lastname or both and updates the profile in the database
      requestBody:
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/updateStudentRequest'
      responses:
        '200':
          description: Returns student updated profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getUser'

        '404':
          description: Student Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'

  /students/change-password:
    put:
      tags:
        - Student
      security:
        - bearer: []
      summary: update student password
      description: This updates the students' password who must be logged in
      requestBody:
        description: Accepts Students' password in the body as a request
        content:
          application/json:
            schema:
              allOf:
                - $ref: '#/components/schemas/updateStudentPasswordRequest'
      responses:
        '200':
          description: Returns the updated Student profile
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/getUser'

        '404':
          description: Student Not Found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/NotFoundError'

components:
  schemas:
    signUpMentorRequest:
      title: sign up mentor request
      required:
        - firstname
        - lastname
        - email
        - track
        - specialization
        - yearsOfExperience
        - password
      type: object
      properties:
        firstname:
          type: string
        lastname:
          type: string
        email:
          type: string
        password:
          type: string
          pattern: '^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])'
          description: password must contain uppercase, lowercase, number and special character
        track:
          type: string
        specialization:
          type: string
        yearsOfExperience:
          type: number
      example:
        firstname: test
        lastname: sample
        email: test@gmail.com
        password: Test12345%
        track: testing
        specialization: sampling
        yearsOfExperience: 1000

    getAllUsers:
      title: get all mentor request
      type: array
      items:
        type: object
        properties:
          _id:
            type: string
          firstname:
            type: string
          lastname:
            type: string
          email:
            type: string
          track:
            type: string
          accountType:
            type: string
          owner:
            type: object
            properties:
              _id:
                type: string
              specialization:
                type: string
              yearsOfExperience:
                type: integer
          createdAt:
            type: string
            default: '2023-01-01T00:10:52.567Z'
          updatedAt:
            type: string
            default: '2023-01-01T00:10:52.567Z'

    getAllStudents:
      title: Get all students request
      type: array
      items:
        type: object
        properties:
          _id:
            type: string
          firstname:
            type: string
          lastname:
            type: string
          email:
            type: string
          track:
            type: string
          accountType:
            type: string
          owner:
            type: object
            properties:
              _id:
                type: string
              matric:
                type: string
              stack:
                type: string
              gender:
                type: string
          createdAt:
            type: string
            default: '2023-01-01T00:10:52.567Z'
          updatedAt:
            type: string
            default: '2023-01-01T00:10:52.567Z'

    getStudent:
      title: Get all students request
      type: object
      properties:
        _id:
          type: string
        firstname:
          type: string
        lastname:
          type: string
        email:
          type: string
        track:
          type: string
        accountType:
          type: string
        owner:
          type: object
          properties:
            _id:
              type: string
            matric:
              type: string
            stack:
              type: string
            gender:
              type: string
        createdAt:
          type: string
          default: '2023-01-01T00:10:52.567Z'
        updatedAt:
          type: string
          default: '2023-01-01T00:10:52.567Z'

    getUser:
      title: get single user request
      type: object
      properties:
        statusCode:
          type: integer
          default: 200
        message:
          type: string
        data:
          type: object
          properties:
            _id:
              type: string
            firstname:
              type: string
            lastname:
              type: string
            email:
              type: string
            track:
              type: string
            accountType:
              type: string
            owner:
              type: string
            createdAt:
              type: string
              default: '2023-01-01T00:10:52.567Z'
            updatedAt:
              type: string
              default: '2023-01-01T00:10:52.567Z'

    updateUserPassword:
      title: get single user request
      type: object
      properties:
        statusCode:
          type: integer
          default: 200
        message:
          type: string
        data:
          type: object
          properties:
            _id:
              type: string
            firstname:
              type: string
            lastname:
              type: string
            email:
              type: string
            track:
              type: string
            accountType:
              type: string
            owner:
              type: string
            createdAt:
              type: string
              default: '2023-01-01T00:10:52.567Z'
            updatedAt:
              type: string
              default: '2023-01-01T00:10:52.567Z'

    loginMentorRequest:
      title: login mentor request
      required:
        - email
        - password
      type: object
      properties:
        email:
          type: string
        password:
          type: string
          pattern: '^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])'
          description: password must contain uppercase, lowercase, number and special character
      example:
        email: test@gmail.com
        password: Test12345%

    updateMentorRequest:
      title: update mentor details
      type: object
      properties:
        firstname:
          type: string
        lastname:
          type: string
      example:
        firstname: newTest
        lastname: newSampling

    updateMentorPasswordRequest:
      title: update mentor api
      type: object
      properties:
        password:
          type: string
      example:
        password: newTestPassword1@

    signUpStudentRequest:
      title: sign up student request
      required:
        - firstname
        - lastname
        - email
        - track
        - password
        - matric
        - stack
        - gender
      type: object
      properties:
        firstname:
          type: string
        lastname:
          type: string
        email:
          type: string
        password:
          type: string
          pattern: '^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])'
          description: password must contain uppercase, lowercase, number and special character
        track:
          type: string
        stack:
          type: string
        matric:
          type: string
        gender:
          type: string
          enum:
            - male
            - female
      example:
        firstname: test
        lastname: sample
        email: test@gmail.com
        password: Test12345%
        track: testing
        stack: backend
        matric: randomMatric123
        gender: male

    loginStudentRequest:
      title: login student request
      required:
        - email
        - password
      type: object
      properties:
        email:
          type: string
        password:
          type: string
          pattern: '^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*])'
          description: password must contain uppercase, lowercase, number and special character
      example:
        email: test@gmail.com
        password: Test12345%

    updateStudentRequest:
      title: update user details
      type: object
      properties:
        firstname:
          type: string
        lastname:
          type: string
      example:
        firstname: newTest
        lastname: newSampling

    updateStudentPasswordRequest:
      title: update student api
      type: object
      properties:
        password:
          type: string
      example:
        password: newTestPassword1@

    ValidationError:
      type: object
      properties:
        messsage:
          type: string
        statusCode:
          type: number
          default: 422
        error:
          type: string
      example:
        statusCode: 422
        message: One or more of user input not validated
        error: Server Error

    ConflictError:
      type: object
      properties:
        message:
          type: string
        statusCode:
          type: number
          default: 409
        error:
          type: string
      example:
        statusCode: 409
        message: User already exists!
        error: Conflict

    MentorCreated:
      type: object
      properties:
        message:
          type: string
        user:
          type: object
          properties:
            account:
              type: object
              properties:
                firstname:
                  type: string
                lastname:
                  type: string
                email:
                  type: string
                track:
                  type: string
                accountType:
                  type: string
                owner:
                  type: string
                _id:
                  type: string
                createdAt:
                  type: string
                  default: '2023-01-01T00:10:52.567Z'
                updatedAt:
                  type: string
                  default: '2023-01-01T00:10:52.567Z'
        mentor:
          type: object
          properties:
            specialization:
              type: string
            yearsOfExperience:
              type: integer
            _id:
              type: string
        data:
          type: object
          properties:
            token:
              type: string

    StudentCreated:
      type: object
      properties:
        message:
          type: string
        user:
          type: object
          properties:
            account:
              type: object
              properties:
                firstname:
                  type: string
                lastname:
                  type: string
                email:
                  type: string
                track:
                  type: string
                accountType:
                  type: string
                owner:
                  type: integer
                _id:
                  type: string
                createdAt:
                  type: string
                  default: '2023-01-01T00:10:52.567Z'
                updatedAt:
                  type: string
                  default: '2023-01-01T00:10:52.567Z'
        student:
          type: object
          properties:
            matric:
              type: string
            stack:
              type: string
            gender:
              type: string
            _id:
              type: string
        data:
          type: object
          properties:
            token:
              type: string

    UserToken:
      type: object
      properties:
        statusCode:
          type: integer
          default: 200
        message:
          type: string
        data:
          type: object
          properties:
            token:
              type: string
        user:
          type: object
          properties:
            _id:
              type: string
            firstname:
              type: string
            lastname:
              type: string
            email:
              type: string
            track:
              type: string
            accountType:
              type: string
            owner:
              type: object
              properties:
                _id:
                  type: string
                specialization:
                  type: string
                yearsOfExperience:
                  type: integer
            createdAt:
              type: string
              default: '2023-01-01T00:10:52.567Z'
            updatedAt:
              type: string
              default: '2023-01-01T00:10:52.567Z'

    UnauthorizedError:
      type: object
      properties:
        statusCode:
          type: integer
          default: 401
        message:
          type: string
        error:
          type: string

    NotFoundError:
      type: object
      properties:
        statusCode:
          type: integer
          default: 404
        message:
          type: string
        error:
          type: string

  securitySchemes:
    bearer:
      type: http
      scheme: bearer
security: []

tags:
  - name: Auth
    description: ''
  - name: Mentor
    description: ''
  - name: Student
    description: ''
